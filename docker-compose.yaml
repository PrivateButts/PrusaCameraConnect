version: '3'
services:
  app:
    image: ghcr.io/privatebutts/prusacameraconnect:latest
    build:
      context: .
      dockerfile: Dockerfile
    restart: unless-stopped
    volumes:
      # You can mount a config file here, or use the APP_CONFIG environment variable
      - ./src/prusacameraconnect/config.yaml:/app/config.yaml
    environment:
      APP_CONFIG: >
        global_config:
          connect_endpoint: "https://connect.prusa3d.com" # URL of Prusa Connect service

        cameras:
          - name: "Prusa MK4"                       # Name of the camera
            fingerprint: ""                         # Unique identifier of the camera, generated by you
            token: ""                               # Token of the camera, from Prusa Connect
            interval: 30                            # Interval between snapshots, in seconds
            handler: "ImageUrl.ImageUrlHandler"     # Handler to use for this camera
            handler_config:                         # Configuration for the handler
              url: "http://example.com/image.jpg"   # URL of the image to display
            printer_link:                           # Optional, if you want to limit snapshots to certain printer states
              url: "http://printer-ip"              # URL of the printer on the local network
              username: "maker"                     # Username for the printer
              password: "password from panel"       # Password for the printer
              snapshot_states:                      # You can remove items from this list to prevent snapshots from being taken in certain printer states
                - IDLE
                - PAUSED
                - ERROR
                - ATTENTION
                - PRINTING
                - FINISHED
